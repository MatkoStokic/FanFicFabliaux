@model BookDataModel

<div class="container">
    <div class="row">
        <div class="col-2">
            <p>Name: @Html.DisplayFor(model => model.Book.Title)</p>
            <p>Author: @Html.DisplayFor(model => model.Book.Author)</p>
            <p>Rating: @Html.DisplayFor(model => model.AverageRating)</p>
            <div class="form-group">
                <span class="text-warning">
                    <i class="ratingStar fas fa-star"></i>
                    <i class="ratingStar far fa-star"></i>
                    <i class="ratingStar far fa-star"></i>
                    <i class="ratingStar far fa-star"></i>
                    <i class="ratingStar far fa-star"></i>
                </span>
            </div>


        </div>
        <div class="col-10">



        </div>
    </div>
    <div class="row">
        <div class="col-2">
            <form asp-action="Subscribe" method="post" id="subscribeForm">
                <input type="hidden" asp-for="Book.UserId" name="AuthorId" />
                <input type="hidden" asp-for="IsSubscribed" />
                <button id="subscribeBtn" class="btn btn-secondary">Subscribe</button>
            </form>

        </div>
    </div>
    <div class="row">
        <section style="background-color: #eee;">
            <div class="container my-5 py-5">
                <div class="row d-flex justify-content-center">
                    <div class="col-md-12 col-lg-10 col-xl-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex flex-start align-items-center">
                                    <div>
                                        <h6 class="fw-bold text-primary mb-1">Lily Coleman</h6>
                                        <p class="text-muted small mb-0">
                                            Shared publicly - Jan 2020
                                        </p>
                                    </div>
                                </div>

                                <p class="mt-3 mb-4 pb-2">
                                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                                    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                                    quis nostrud exercitation ullamco laboris nisi ut aliquip consequat.
                                </p>

                                <div class="small d-flex justify-content-start">
                                    <a href="#!" class="d-flex align-items-center me-3">
                                        <i class="far fa-thumbs-up me-2"></i>
                                        <p class="mb-0">Like</p>
                                    </a>
                                    <a href="#!" class="d-flex align-items-center me-3">
                                        <i class="far fa-comment-dots me-2"></i>
                                        <p class="mb-0">Comment</p>
                                    </a>
                                    <a href="#!" class="d-flex align-items-center me-3">
                                        <i class="fas fa-share me-2"></i>
                                        <p class="mb-0">Share</p>
                                    </a>
                                </div>
                            </div>
                            <div class="card-footer py-3 border-0" style="background-color: #f8f9fa;">
                                <div class="d-flex flex-start w-100">
                                    <div class="form-outline w-100">
                                        <textarea class="form-control" id="textAreaExample" rows="4"
                                                  style="background: #fff;"></textarea>
                                        <label class="form-label" for="textAreaExample">Message</label>
                                    </div>
                                </div>
                                <div class="float-end mt-2 pt-1">
                                    <button type="button" class="btn btn-primary btn-sm">Post comment</button>
                                    <button type="button" class="btn btn-outline-primary btn-sm">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>


    </div>
</div>

<script>
    $("#subscribeForm").submit(function (e) {

        e.preventDefault(); // avoid to execute the actual submit of the form.

        var form = $(this);
        var actionUrl = form.attr('action');

        $.ajax({
            type: "POST",
            url: actionUrl,
            data: form.serialize(), // serializes the form's elements.
            success: function (data) {
                $("#IsSubscribed").val(data);
                toggleSubscribe(data);
            }
        });

    });

    function toggleSubscribe() {
        var isSubscribed = $("#IsSubscribed").val();

        const subBtn = $("#subscribeBtn");
        if (isSubscribed === 'true') {
            subBtn.addClass("btn-outline-secondary");
            subBtn.removeClass("btn-secondary");
            subBtn.text("Unsubscribe");
        } else {
            subBtn.addClass("btn-secondary");
            subBtn.removeClass("btn-outline-secondary");
            subBtn.text("Subscribe");
        }
    }

    toggleSubscribe();
</script>
